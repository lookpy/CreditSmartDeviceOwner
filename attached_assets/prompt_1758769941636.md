 DOM√çNIO DE PRODU√á√ÉO
https://cdccreditsmart.com
üîë 1. AUTENTICA√á√ÉO APK
POST /api/apk/auth
Autentica√ß√£o inicial do dispositivo APK:

curl -X POST https://cdccreditsmart.com/api/apk/auth \
  -H "Content-Type: application/json" \
  -d '{
    "token": "DEVICE_TOKEN_OR_SERIAL"
  }'
Resposta de Sucesso:

{
  "success": true,
  "device": {
    "id": "device-uuid",
    "serialNumber": "DEV001",
    "status": "active",
    "imei": "123456789012345"
  },
  "paymentInfo": {
    "totalInstallments": 12,
    "paidInstallments": 3,
    "overdueAmount": 0,
    "nextDueDate": "2025-10-15"
  }
}
üì± 2. QR CODE PROVISIONING
GET /api/apk/provisioning-qr
Obter dados para provisionamento Device Owner:

curl -X GET https://cdccreditsmart.com/api/apk/provisioning-qr
Resposta:

{
  "success": true,
  "provisioning": {
    "qrCode": "eyJhbmRyb2lkLmFwcC5leHRyYS5QUk9WSVNJT05JTkdfREVWSUNFX0FETUlOX0NPTVBPTkVOVF9OQU1FIjoiY29tLmNkY2NyZWRpdHNtYXJ0LmFuZHJvaWQvLmFkbWluLkFkdmFuY2VkRGV2aWNlQWRtaW5SZWNlaXZlciIsImFuZHJvaWQuYXBwLmV4dHJhLlBST1ZJU0lPTklOR19ERVZJQ0VfQURNSU5fUEFDS0FHRV9ET1dOTE9BRF9MT0NBVElPTiI6Imh0dHA6Ly8xOTIuMTY4LjEuMTA6NTAwMC9hcGkvYXBrL2Rvd25sb2FkL2Fway0xNzU4NzYzODQ0MDE0LTYyMjQyMzU1MC5hcGsiLCJhbmRyb2lkLmFwcC5leHRyYS5QUk9WSVNJT05JTkdfREVWSUNFX0FETUlOX1BBQ0tBR0VfQ0hFQ0tTVU0iOiJOV2dHNS8wbzF5VkxpTzRMYnRhemFmSEE5Q2tnSnlQam9XMTdSWGZQT3lNPSIsImFuZHJvaWQuYXBwLmV4dHJhLlBST1ZJU0lPTklOR19ERVZJQ0VfQURNSU5fUEFDS0FHRV9OQU1FIjoiY29tLmNkY2NyZWRpdHNtYXJ0LmFuZHJvaWQifQ==",
    "downloadUrl": "https://cdccreditsmart.com/api/apk/download/apk-file.apk",
    "checksum": "NWgG5/0o1yVLiO4LbtazafHA9CkgJyPjoW17RXfPOyM=",
    "packageName": "com.cdccreditsmart.android",
    "componentName": "com.cdccreditsmart.android/.admin.AdvancedDeviceAdminReceiver"
  },
  "metadata": {
    "version": "1.0.0",
    "buildTimestamp": "2025-09-25T02:18:37.000Z"
  }
}
üîç 3. VALIDA√á√ÉO DE IMEI
POST /api/validate-imei
Validar IMEI do dispositivo (requer autentica√ß√£o):

curl -X POST https://cdccreditsmart.com/api/validate-imei \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -d '{
    "imei": "352096325698365",
    "expectedBrand": "Samsung",
    "expectedModel": "Galaxy A54"
  }'
Resposta V√°lida:

{
  "success": true,
  "message": "‚úÖ DISPOSITIVO VERIFICADO",
  "validation": {
    "imei": "352096325698365",
    "brand": "Samsung",
    "model": "Galaxy A54 5G",
    "validationTimestamp": "2025-09-25T02:32:18.454Z"
  }
}
Resposta Inv√°lida:

{
  "success": false,
  "message": "üö´ DISPOSITIVO N√ÉO COMPAT√çVEL",
  "error": "IMEI_BRAND_MISMATCH",
  "validation": {
    "expected": {
      "brand": "Samsung",
      "model": "Galaxy A54"
    },
    "found": {
      "brand": "INFINIX",
      "model": "Hot 50 Pro+ 4G"
    }
  }
}
üìä 4. STATUS DO DISPOSITIVO
GET /api/apk/device/{serial}/status
Obter status de pagamentos do dispositivo:

curl -X GET https://cdccreditsmart.com/api/apk/device/DEV001/status
Resposta:

{
  "serialNumber": "DEV001",
  "status": "active",
  "paymentStatus": {
    "totalInstallments": 12,
    "paidInstallments": 3,
    "overdueCount": 0,
    "nextDueDate": "2025-10-15",
    "amountDue": 299.90
  },
  "deviceInfo": {
    "blocked": false,
    "lastSyncAt": "2025-09-25T02:30:00.000Z"
  }
}
üîÑ 5. SINCRONIZA√á√ÉO HEARTBEAT
POST /api/apk/device/{fingerprint}/sync
Sincroniza√ß√£o peri√≥dica (heartbeat):

curl -X POST https://cdccreditsmart.com/api/apk/device/DEVICE_FINGERPRINT/sync \
  -H "Content-Type: application/json" \
  -d '{
    "lastSyncAt": "2025-09-25T02:30:00.000Z",
    "batteryLevel": 85,
    "locationPermission": true
  }'
Resposta:

{
  "success": true,
  "commands": [],
  "settings": {
    "blockingEnabled": true,
    "syncIntervalMinutes": 30
  },
  "serverTime": "2025-09-25T02:35:00.000Z"
}
üì± 6. REGISTRO DE INFORMA√á√ïES
POST /api/apk/device/{fingerprint}/register-info
Registrar informa√ß√µes do dispositivo:

curl -X POST https://cdccreditsmart.com/api/apk/device/DEVICE_FINGERPRINT/register-info \
  -H "Content-Type: application/json" \
  -d '{
    "deviceInfo": {
      "model": "Galaxy A54",
      "androidVersion": "13",
      "buildNumber": "A546BXXU4CWK2"
    },
    "appInfo": {
      "version": "1.0.0",
      "installationId": "install-uuid"
    }
  }'
üöÄ 7. WEBHOOKS FLOW (TEMPO REAL)
WebSocket Connection
wss://cdccreditsmart.com/ws/flow-status
Flow Event APIs (para disparar eventos):
POST /api/flow/device-attestation-start
curl -X POST https://cdccreditsmart.com/api/flow/device-attestation-start \
  -H "Authorization: Bearer JWT_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "contractId": "CTR_123456",
    "data": {
      "imei": "123456789012345",
      "deviceModel": "Galaxy A54"
    }
  }'
POST /api/flow/device-imei-verification
POST /api/flow/device-bind-success
POST /api/flow/device-bind-error
POST /api/flow/biometric-validation-start
POST /api/flow/biometric-approved
üîê 8. VARI√ÅVEIS DE AMBIENTE NECESS√ÅRIAS
Para funcionalidade completa, configure:

IMEI_INFO_API_KEY=sua_chave_imei_info_api
DATABASE_URL=sua_url_postgres
JWT_SECRET=seu_jwt_secret
üìã 9. FLUXO COMPLETO DE INTEGRA√á√ÉO
Device Owner Setup: Escanear QR Code de /api/apk/provisioning-qr
Primeira Conex√£o: POST /api/apk/auth com token
Registro: POST /api/apk/device/{fingerprint}/register-info
Valida√ß√£o IMEI: POST /api/validate-imei
Heartbeat: POST /api/apk/device/{fingerprint}/sync (a cada 30min)
WebSocket: Conectar em wss://cdccreditsmart.com/ws/flow-status
‚ö° 10. RATE LIMITS
APK Routes: 100 requests/hour por IP
Flow Events: 50 requests/hour
IMEI Validation: 20 requests/hour
üõ°Ô∏è 11. AUTENTICA√á√ÉO
Rotas APK b√°sicas: Sem autentica√ß√£o
Flow events: JWT Token obrigat√≥rio
IMEI validation: JWT Token obrigat√≥rio