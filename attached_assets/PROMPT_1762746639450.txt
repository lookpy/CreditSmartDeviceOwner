PROMPT PARA IA CRIADORA DO APK ‚Äî CDC CREDIT SMART (Bloqueios Progressivos e Tela de Bloqueio Knox)

Voc√™ √© o assistente de desenvolvimento respons√°vel por criar e programar o APK oficial do CDC Credit Smart, um aplicativo corporativo usado para controle de financiamento de aparelhos celulares.
Sua miss√£o √© implementar bloqueios progressivos de aplicativos com base nos dias de atraso do cliente e avisos autom√°ticos na tela de bloqueio (Lockscreen) usando a API Samsung Knox.

Siga rigorosamente as regras abaixo.

üß© 1. Estrutura do Sistema

O app deve operar em modo Device Owner (MDM) para ter permiss√£o de bloquear apps e gerenciar o dispositivo.

Caso o dispositivo n√£o suporte Device Owner, implemente fallback com:

UsageStatsManager para identificar apps em uso;

AccessibilityService + overlay de bloqueio sobre o app proibido.

O app deve verificar diariamente o n√∫mero de dias de atraso (daysOverdue) e aplicar automaticamente as restri√ß√µes correspondentes.

üìÖ 2. Regras de Bloqueio Progressivo (Escalonamento)

As restri√ß√µes s√£o cumulativas ‚Äî cada n√≠vel mant√©m os anteriores.

üîπ Ap√≥s 7 dias de atraso

Bloquear:

Apps de fotos, galeria, v√≠deos e navegadores.

Permitir:

WhatsApp, telefone, SMS, apps banc√°rios e e-mail.

Mensagem da tela de bloqueio:

Dispositivo com atraso de 7 dias.
Aplicativos de fotos, galeria, v√≠deos e navegadores foram bloqueados.
Regularize seu pagamento para evitar novas restri√ß√µes.

üîπ Ap√≥s 15 dias de atraso

Bloquear tamb√©m:

YouTube, apps de m√∫sica, Play Store e jogos.

Mensagem da tela de bloqueio:

Atraso de 15 dias.
YouTube, m√∫sica, jogos e Play Store foram bloqueados.
Regularize seu pagamento para restaurar o acesso.

üîπ Ap√≥s 30 dias de atraso

Bloquear todas as redes sociais, exceto WhatsApp.

Mensagem:

Atraso de 30 dias.
Todas as redes sociais est√£o bloqueadas, exceto o WhatsApp.
Regularize o pagamento para liberar o uso completo.

üîπ Ap√≥s 45 dias de atraso

Bloquear todos os aplicativos, exceto:

WhatsApp, telefone, SMS, bancos e e-mails.

Mensagem:

Atraso de 45 dias.
A maioria dos aplicativos foi bloqueada, apenas WhatsApp e comunica√ß√µes essenciais permanecem ativas.

üîπ Ap√≥s 60 dias de atraso

Bloquear todos os aplicativos, exceto:

Apps de banco, telefone, SMS e e-mail.

Mensagem:

Atraso de 60 dias.
Acesso restrito apenas a chamadas, SMS, bancos e e-mails.
Regularize seu pagamento imediatamente para restaurar o uso completo do aparelho.

üñºÔ∏è 3. Exibi√ß√£o Visual (LockscreenOverlay ‚Äì Samsung Knox)

Utilize a classe com.samsung.android.knox.lockscreen.LockscreenOverlay para aplicar:

Mensagem na tela de bloqueio via changeLockScreenString(String text);

Wallpaper de aviso com setWallpaper(String path);

Transpar√™ncia ajust√°vel com setAlpha(float value).

Para cada n√≠vel de atraso, use um wallpaper correspondente, por exemplo:

/storage/emulated/0/CDC/wallpapers/atraso_7.png

/storage/emulated/0/CDC/wallpapers/atraso_15.png

etc.

Exemplo de uso:

overlay.changeLockScreenString(mensagem);
overlay.setWallpaper(caminhoWallpaper);
overlay.setAlpha(0.8f);

üîê 4. Whitelist (apps que nunca devem ser bloqueados)

Mesmo em bloqueios severos, os seguintes pacotes sempre devem permanecer ativos:

{
  "whitelist": [
    "com.whatsapp",
    "com.android.dialer",
    "com.android.messaging",
    "com.google.android.gm",
    "com.microsoft.office.outlook",
    "br.com.bb",
    "com.itau",
    "com.santander.app",
    "br.com.bradesco",
    "com.google.android.apps.messaging"
  ]
}

üß≠ 5. Integra√ß√£o com Backend

O backend retorna daysOverdue e amountDue (valor em aberto).

Ap√≥s receber esses dados:

Aplicar bloqueio progressivo conforme tabela.

Atualizar lockscreen com mensagem e wallpaper correspondentes.

Enviar log de execu√ß√£o para o servidor:

{
  "deviceId": "...",
  "daysOverdue": 45,
  "actionsApplied": ["blocked_apps", "lockscreen_updated"],
  "timestamp": "2025-11-10T22:00:00Z"
}


Quando daysOverdue == 0, desbloquear tudo e restaurar lockscreen padr√£o.

üß∞ 6. Seguran√ßa

Evitar que o usu√°rio possa desinstalar o app (usar Device Owner setUninstallBlocked(true)).

Garantir que chamadas de emerg√™ncia (112/190/192) permane√ßam funcionais.

Nunca apagar dados do usu√°rio, apenas restringir uso.

üí¨ 7. UX / Mensagens

Mostrar sempre notifica√ß√µes amig√°veis com:

Dias de atraso

Valor em aberto

Bot√£o ‚ÄúPagar agora‚Äù abrindo o app CDC Credit Smart.

Exemplo:

NotificationCompat.Builder builder = new NotificationCompat.Builder(context, "cdc_lock")
    .setSmallIcon(R.drawable.ic_lock)
    .setContentTitle("Atraso de 30 dias detectado")
    .setContentText("Redes sociais bloqueadas. Toque aqui para regularizar.")
    .setPriority(NotificationCompat.PRIORITY_HIGH);

üß† 8. Comportamento esperado

O app deve iniciar automaticamente com o sistema (BOOT_COMPLETED) e aplicar as regras assim que poss√≠vel.

O bloqueio deve persistir ap√≥s reiniciar o celular.

Ao confirmar o pagamento, as restri√ß√µes s√£o removidas em tempo real.

‚úÖ 9. Testes obrigat√≥rios

Simular atrasos de 7, 15, 30, 45 e 60 dias.

Testar desbloqueio p√≥s-pagamento.

Testar fallback em dispositivos sem Knox.

Confirmar que WhatsApp, telefone e SMS funcionam em todos os n√≠veis.

üìú Resumo

Crie o APK do CDC Credit Smart com:

Bloqueios progressivos autom√°ticos conforme dias de atraso;

Exibi√ß√£o de mensagem personalizada na lockscreen via Samsung Knox;

Notifica√ß√µes e wallpapers informativos;

Mecanismo revers√≠vel ap√≥s pagamento;

Opera√ß√£o persistente e segura em modo Device Owner.